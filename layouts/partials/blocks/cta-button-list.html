{{/* layouts/partials/blocks/cta-button-list.html - robust override */}}
{{ $page := .wcPage }}
{{ $block := .wcBlock }}

{{/* Visible marker so you know the override is being used (remove later) */}}
<!-- CTA-BUTTON-LIST OVERRIDE ACTIVE -->

{{/* Helper: try several common locations for title/subtitle/text */}}
{{ $titleCandidates := slice
    ($block.content.title) 
    ($block.title) 
    ($block.Params.title) 
    ($block.params.title) 
    ($block.params.subtitle) 
    ($block.content.heading)
    ($block.Params.heading)
}}
{{ $textCandidates := slice
    ($block.content.text)
    ($block.content.subtitle)
    ($block.Params.text)
    ($block.params.text)
    ($block.params.subtitle)
    ($block.subtitle)
}}

{{/* pick first non-empty */}}
{{ $title := "" }}
{{ range $i, $c := $titleCandidates }}{{ if and (ne $title "") false }}{{ else if $c }}{{ $title = $c }}{{ end }}{{ end }}
{{ $text := "" }}
{{ range $i, $c := $textCandidates }}{{ if and (ne $text "") false }}{{ else if $c }}{{ $text = $c }}{{ end }}{{ end }}

{{/* DEBUG: uncomment the pre block below to see the structure of $block in the page */}}
{{/* <pre style="white-space:pre-wrap;background:#fff;padding:10px;border:1px solid #ddd">DEBUG $block content:
{{ printf "%#v" $block }}
</pre> */}}

{{/* Render title/subtitle/text if present */}}
{{ if $title }}
  <h2 class="section-title text-3xl font-bold mb-2 text-center">
    {{ $title | markdownify | emojify | safeHTML }}
  </h2>
{{ end }}

{{ if $block.content.subtitle }}
  <h3 class="text-xl font-semibold mb-2 text-center">{{ $block.content.subtitle | markdownify | emojify | safeHTML }}</h3>
{{ end }}

{{ if $text }}
  <p class="section-text text-lg mb-6 text-center text-gray-600">
    {{ $text | markdownify | emojify | safeHTML }}
  </p>
{{ end }}

{{/* If nothing at all displayed, print tiny hint for troubleshooting */}}
{{ if and (not $title) (not $text) }}
  <div class="text-sm text-red-600 text-center mb-3">[CTA block: no title/text found â€” enable debug to inspect]</div>
{{ end }}

<div class="flex items-center flex-col mx-auto w-full justify-center mt-4 px-8 pb-5">
  {{ $buttons := $block.content.buttons | default (or $block.Params.buttons $block.buttons) }}
  {{ range $index, $item := $buttons }}
    <a href="{{ $item.url }}" target="_blank" rel="noopener noreferrer" class="flex items-center p-1 w-full rounded-md hover:scale-105 transition-all bg-gray-100 mb-3 max-w-3xl">
      <div class="flex text-center w-full">
        <div class="w-10 h-10 text-gray-700">
          {{ with $item.icon }}
            {{ partial "functions/get_icon" (dict "name" . "attributes" "height=\"40\" width=\"40\" class=\"rounded-sm\"") }}
          {{ end }}
        </div>
        <div class="flex justify-center items-center font-semibold w-full text-gray-700 -ml-10">
          {{ $item.text | markdownify | emojify }}
        </div>
      </div>
    </a>
  {{ end }}
</div>
